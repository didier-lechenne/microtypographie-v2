/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
Typography Fixers Plugin for Obsidian
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var R=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var U=(o,e)=>{for(var t in e)R(o,t,{get:e[t],enumerable:!0})},B=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of w(e))!P.call(o,i)&&i!==t&&R(o,i,{get:()=>e[i],enumerable:!(r=O(e,i))||r.enumerable});return o};var I=o=>B(R({},"__esModule",{value:!0}),o);var $={};U($,{default:()=>v});module.exports=I($);var p=require("obsidian");var l=class{constructor(){this.enabled=!0;this.locale="fr-FR"}setLocale(e){this.locale=e}isLocaleCompatible(e){return e.some(t=>this.locale.startsWith(t))}isActive(){return this.enabled}applyRegexTransform(e,t,r){return e.replace(t,r)}applyMultipleTransforms(e,t){return t.reduce((r,i)=>typeof i.replacement=="string"?this.applyRegexTransform(r,i.pattern,i.replacement):this.applyRegexTransform(r,i.pattern,i.replacement),e)}isValidContext(e,t){let r=e.substring(Math.max(0,t-10),t),i=e.substring(t,Math.min(e.length,t+10));return!(r.includes("`")&&i.includes("`")||r.includes("[")&&i.includes("]"))}logCorrection(e,t){}};var s={NO_BREAK_THIN_SPACE:"\u202F",NO_BREAK_SPACE:"\xA0",NORMAL_SPACE:" ",ELLIPSIS:"\u2026",NDASH:"\u2013",MDASH:"\u2014",LDQUO:"\u201C",RDQUO:"\u201D",LSQUO:"\u201C",RSQUO:"\u2019",LAQUO:"\xAB",RAQUO:"\xBB",BDQUO:"\u201E",SHY:"\xC2\xAD",TIMES:"\xD7",DIVIDE:"\xF7",PLUS_MINUS:"\xB1",MINUS:"\u2212",TRADE:"\u2122",REG:"\xAE",COPY:"\xA9",PRIME:"\u2032",DOUBLE_PRIME:"\u2033",SECTION:"\xA7",PARAGRAPH:"\xB6",BULLET:"\u2022",ARROW_RIGHT:"\u2192",ARROW_LEFT:"\u2190",EURO:"\u20AC",POUND:"\xA3",YEN:"\xA5"},_={MULTIPLE_SPACES:/\s{2,}/g,ELLIPSIS_DOTS:/\.{3,}/g,DOUBLE_DASH:/--/g,STRAIGHT_QUOTES:/"/g,STRAIGHT_APOSTROPHES:/(\w)'/g,MULTIPLY_X:/(\d+)\s*[xX]\s*(\d+)/g,MULTIPLY_STAR:/(\d+)\s*\*\s*(\d+)/g,TRADEMARK_TEXT:/\(tm\)/gi,REGISTERED_TEXT:/\(r\)/gi,COPYRIGHT_TEXT:/\(c\)/gi};var h=class extends l{constructor(){super(...arguments);this.id="Ellipsis";this.name="Points de suspension";this.description="Remplace ... par le caract\xE8re ellipse Unicode (\u2026)";this.category="punctuation";this.priority=1}fix(t){return this.applyRegexTransform(t,_.ELLIPSIS_DOTS,s.ELLIPSIS)}handleKeyEvent(t,r){if(t.key==="."&&!t.ctrlKey&&!t.metaKey){let i=r.getCursor(),n=r.getLine(i.line);if(n.substring(0,i.ch).endsWith("..")){let a=n.substring(0,i.ch-2)+s.ELLIPSIS+n.substring(i.ch);return r.setLine(i.line,a),r.setCursor({line:i.line,ch:i.ch-1}),!0}}return!1}getExample(){return{before:"En fait... c'est compliqu\xE9...",after:`En fait${s.ELLIPSIS} c'est compliqu\xE9${s.ELLIPSIS}`}}};var y=class extends l{constructor(){super(...arguments);this.id="Dash";this.name="Tirets typographiques";this.description="Convertit -- en \u2014 et am\xE9liore les tirets entre nombres";this.category="punctuation";this.priority=2}fix(t){let r=[{pattern:/--/g,replacement:s.MDASH},{pattern:/(\d+)\s*-\s*(\d+)/g,replacement:`$1${s.NDASH}$2`},{pattern:/\s*—\s*/g,replacement:this.isLocaleCompatible(["fr"])?` ${s.MDASH} `:`${s.MDASH}`}];return this.applyMultipleTransforms(t,r)}handleKeyEvent(t,r){if(t.key==="-"&&!t.ctrlKey&&!t.metaKey){let i=r.getCursor(),n=r.getLine(i.line);if(n.substring(0,i.ch).endsWith("-")){let a=this.isLocaleCompatible(["fr"])?` ${s.MDASH} `:`${s.MDASH}`,c=n.substring(0,i.ch-1)+a+n.substring(i.ch);return r.setLine(i.line,c),r.setCursor({line:i.line,ch:i.ch-1+a.length}),!0}}return!1}getExample(){let t=this.isLocaleCompatible(["fr"])?" \u2014 ":"\u2014";return{before:"P\xE9riode 2020-2024 -- une \xE9poque importante",after:`P\xE9riode 2020${s.NDASH}2024${t}une \xE9poque importante`}}};var f=class extends l{constructor(){super(...arguments);this.id="FrenchNoBreakSpace";this.name="Espaces fran\xE7ais";this.description="Ajoute des espaces ins\xE9cables selon les r\xE8gles fran\xE7aises";this.category="spacing";this.priority=3;this.enabled=!0}fix(t){if(!this.isLocaleCompatible(["fr"]))return t;let r=[{pattern:/\s*([;!?»])/g,replacement:`${s.NO_BREAK_THIN_SPACE}$1`},{pattern:/\s*(:)/g,replacement:`${s.NO_BREAK_SPACE}$1`},{pattern:/(«)\s*/g,replacement:`$1${s.NO_BREAK_SPACE}`},{pattern:/(\d)\s+(\d{3})/g,replacement:`$1${s.NO_BREAK_THIN_SPACE}$2`}];return this.applyMultipleTransforms(t,r)}handleKeyEvent(t,r){if(!this.isLocaleCompatible(["fr"]))return!1;let i={"!":s.NO_BREAK_THIN_SPACE,"?":s.NO_BREAK_THIN_SPACE,";":s.NO_BREAK_THIN_SPACE,":":s.NO_BREAK_SPACE};if(i[t.key]&&!t.ctrlKey&&!t.metaKey){let n=r.getCursor(),u=r.getLine(n.line),c=u.substring(0,n.ch).replace(/\s+$/,""),g=i[t.key],m=c+g+t.key+u.substring(n.ch);return r.setLine(n.line,m),r.setCursor({line:n.line,ch:c.length+2}),!0}return!1}getExample(){return{before:"Bonjour ! Comment allez-vous ? Tr\xE8s bien ; merci.",after:`Bonjour${s.NO_BREAK_THIN_SPACE}! Comment allez-vous${s.NO_BREAK_THIN_SPACE}? Tr\xE8s bien${s.NO_BREAK_THIN_SPACE}; merci.`}}};var x=class extends l{constructor(){super(...arguments);this.id="NoSpaceBeforeComma";this.name="Virgules sans espace";this.description="Supprime les espaces avant les virgules et normalise l'espacement";this.category="spacing";this.priority=6}fix(t){let r=[{pattern:/\s+,/g,replacement:","},{pattern:/,\s*/g,replacement:", "},{pattern:/,\s*$/gm,replacement:","},{pattern:/,\s*([)\]}])/g,replacement:",$1"}];return this.applyMultipleTransforms(t,r)}getExample(){return{before:"Pommes , poires,oranges ,bananes",after:"Pommes, poires, oranges, bananes"}}};var b=class extends l{constructor(){super(...arguments);this.id="SmartQuotes";this.name="Guillemets intelligents";this.description="Convertit les guillemets droits en guillemets typographiques";this.category="quotes";this.priority=4}fix(t){return this.isLocaleCompatible(["fr"])?this.fixFrenchQuotes(t):this.fixEnglishQuotes(t)}fixFrenchQuotes(t){let r=t,i=!1;return r=r.replace(/"/g,()=>i?(i=!1,`${s.NO_BREAK_SPACE}${s.RAQUO}`):(i=!0,`${s.LAQUO}${s.NO_BREAK_SPACE}`)),r=r.replace(/'/g,s.RSQUO),r}fixEnglishQuotes(t){let r=t,i=!1;return r=r.replace(/"/g,()=>i?(i=!1,s.RDQUO):(i=!0,s.LDQUO)),r=r.replace(/(\w)'/g,`$1${s.RSQUO}`),r}getExample(){return this.isLocaleCompatible(["fr"])?{before:`Il a dit "Bonjour" et c'est parti.`,after:`Il a dit ${s.LAQUO}${s.NO_BREAK_SPACE}Bonjour${s.NO_BREAK_SPACE}${s.RAQUO} et c${s.RSQUO}est parti.`}:{before:`He said "Hello" and it's done.`,after:`He said ${s.LDQUO}Hello${s.RDQUO} and it${s.RSQUO}s done.`}}};function L(){return[new h,new y,new f,new x,new b]}var C=class{constructor(e){this.fixers=new Map;this.settings=e,this.initializeFixers()}initializeFixers(){L().forEach(t=>{this.fixers.set(t.id,t),t.id in this.settings.fixers&&(t.enabled=this.settings.fixers[t.id]),t.setLocale&&t.setLocale(this.settings.locale)})}updateSettings(e){this.settings=e,this.fixers.forEach(t=>{t.id in e.fixers&&(t.enabled=e.fixers[t.id]),t.setLocale&&t.setLocale(e.locale)})}getFixers(){return Array.from(this.fixers.values()).sort((e,t)=>e.priority-t.priority)}getEnabledFixers(){return this.getFixers().filter(e=>e.enabled)}getFixersByCategory(e){return this.getFixers().filter(t=>t.category===e)}getFixer(e){return this.fixers.get(e)}processText(e){return this.getEnabledFixers().reduce((r,i)=>{try{return i.fix(r)}catch(n){return r}},e)}processTextWithDetails(e){let t=e,r=this.getEnabledFixers(),i=[],n=0,u=r.reduce((a,c)=>{try{let g=c.fix(a);return g!==a&&(i.push(c.id),n++),g}catch(g){return a}},e);return{original:t,corrected:u,correctionsCount:n,fixersUsed:i}}handleKeyEvent(e,t){if(!this.settings.enableRealTimeCorrection)return!1;let r=this.getEnabledFixers();for(let i of r)if(i.handleKeyEvent)try{if(i.handleKeyEvent(e,t))return!0}catch(n){}return!1}toggleFixer(e,t){let r=this.fixers.get(e);return r?(r.enabled=t,this.settings.fixers[e]=t,!0):!1}toggleCategory(e,t){let r=this.getFixersByCategory(e);return r.forEach(i=>{i.enabled=t,this.settings.fixers[i.id]=t}),r.length}resetToDefaults(){this.fixers.forEach(e=>{let t=this.getDefaultEnabledState(e.id);e.enabled=t,this.settings.fixers[e.id]=t})}getDefaultEnabledState(e){let t=["ellipsis","dash","french-spacing","smart-quotes","comma"],r=["ellipsis","dash","smart-quotes","comma"];return this.settings.locale.startsWith("fr")?t.includes(e):r.includes(e)}};var d=require("obsidian");var E={enableRealTimeCorrection:!0,locale:"fr_FR",fixers:{Ellipsis:!0,Dash:!0,SmartQuotes:!0,CurlyQuote:!0,FrenchNoBreakSpace:!0,NoSpaceBeforeComma:!0,Unit:!0,Dimension:!0,Hyphen:!1,Trademark:!0}},T={en_GB:["Ellipsis","Dimension","Unit","Dash","SmartQuotes","NoSpaceBeforeComma","CurlyQuote","Hyphen","Trademark"],fr_FR:["Ellipsis","Dimension","Unit","Dash","SmartQuotes","FrenchNoBreakSpace","NoSpaceBeforeComma","CurlyQuote","Hyphen","Trademark"],fr_CA:["Ellipsis","Dimension","Unit","Dash","SmartQuotes","NoSpaceBeforeComma","CurlyQuote","Hyphen","Trademark"],de_DE:["Ellipsis","Dimension","Unit","Dash","SmartQuotes","NoSpaceBeforeComma","CurlyQuote","Hyphen","Trademark"]},F={fr_FR:"\u{1F1EB}\u{1F1F7} Fran\xE7ais (France)",fr_CA:"\u{1F1E8}\u{1F1E6} Fran\xE7ais (Canada)",en_GB:"\u{1F1EC}\u{1F1E7} English (UK)",de_DE:"\u{1F1E9}\u{1F1EA} Deutsch (Deutschland)"};function N(o){var t,r;let e={enableRealTimeCorrection:(t=o.enableRealTimeCorrection)!=null?t:E.enableRealTimeCorrection,locale:(r=o.locale)!=null?r:E.locale,fixers:{...E.fixers,...o.fixers}};return Object.keys(E.fixers).forEach(i=>{typeof e.fixers[i]!="boolean"&&(e.fixers[i]=E.fixers[i])}),e.locale in T||(e.locale="fr_FR"),e}var D={punctuation:"Ponctuation",spacing:"Espacement",quotes:"Guillemets",symbols:"Symboles"};var A=class extends d.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Param\xE8tres Typography Fixers"}),e.createEl("p",{text:"Plugin de correction typographique bas\xE9 sur JoliTypo. Corrige automatiquement les erreurs typographiques selon les r\xE8gles fran\xE7aises, anglaises et allemandes.",cls:"setting-item-description"}),this.createGeneralSettings(e),this.createFixerSettings(e),this.createActionsSection(e),this.addCustomStyles(e)}createGeneralSettings(e){e.createEl("h3",{text:"Configuration g\xE9n\xE9rale"}),new d.Setting(e).setName("Correction en temps r\xE9el").setDesc("Active la correction automatique pendant la frappe").addToggle(i=>i.setValue(this.plugin.settings.enableRealTimeCorrection).onChange(async n=>{this.plugin.settings.enableRealTimeCorrection=n,await this.plugin.saveSettings()})),new d.Setting(e).setName("Langue typographique").setDesc("Choisissez les r\xE8gles typographiques \xE0 appliquer. Change automatiquement les fixers recommand\xE9s.").addDropdown(i=>(Object.entries(F).forEach(([n,u])=>{i.addOption(n,u)}),i.setValue(this.plugin.settings.locale).onChange(async n=>{this.plugin.settings.locale=n,this.updateFixersForLocale(n),await this.plugin.saveSettings()})));let t=Object.values(this.plugin.settings.fixers).filter(Boolean).length,r=Object.keys(this.plugin.settings.fixers).length;e.createEl("p",{text:`${t}/${r} r\xE8gles activ\xE9es pour ${F[this.plugin.settings.locale]}`,cls:"setting-item-description"})}createFixerSettings(e){e.createEl("h3",{text:"R\xE8gles de correction"}),e.createEl("p",{text:"Activez ou d\xE9sactivez les r\xE8gles typographiques selon vos besoins. Les r\xE8gles recommand\xE9es pour votre langue sont activ\xE9es automatiquement.",cls:"setting-item-description"});let t=this.plugin.engine.getFixers().reduce((r,i)=>(r[i.category]||(r[i.category]=[]),r[i.category].push(i),r),{});Object.entries(t).forEach(([r,i])=>{e.createEl("h4",{text:D[r]||r,cls:"typography-category-header"}).createEl("button",{text:"Tout basculer",cls:"typography-toggle-category"}).addEventListener("click",async()=>{let c=!i.every(g=>g.enabled);i.forEach(g=>{this.plugin.settings.fixers[g.id]=c}),await this.plugin.saveSettings(),this.display()}),i.forEach(a=>{let c=new d.Setting(e).setName(a.name).setDesc(a.description).addToggle(m=>m.setValue(a.enabled).onChange(async S=>{this.plugin.settings.fixers[a.id]=S,await this.plugin.saveSettings()}));if(this.isFixerRecommendedForCurrentLocale(a.id)){let m=c.nameEl.createEl("span",{text:"Recommand\xE9",cls:"typography-recommended-badge"})}if(a.getExample){let m=a.getExample(),S=c.descEl.createDiv({cls:"typography-example"});S.createDiv({cls:"typography-example-before"}).innerHTML=`<span class="typography-example-label">Avant :</span> <code>${m.before}</code>`,S.createDiv({cls:"typography-example-after"}).innerHTML=`<span class="typography-example-label">Apr\xE8s :</span> <code>${m.after}</code>`}})})}createActionsSection(e){e.createEl("h3",{text:"Actions"}),new d.Setting(e).setName("Restaurer la configuration recommand\xE9e").setDesc(`Active les fixers recommand\xE9s pour ${F[this.plugin.settings.locale]}`).addButton(t=>t.setButtonText("Restaurer").onClick(async()=>{this.updateFixersForLocale(this.plugin.settings.locale),await this.plugin.saveSettings(),new d.Notice("Configuration restaur\xE9e")}))}updateFixersForLocale(e){let t=T[e];t&&(Object.keys(this.plugin.settings.fixers).forEach(r=>{this.plugin.settings.fixers[r]=!1}),t.forEach(r=>{this.plugin.settings.fixers[r]=!0}),this.display())}isFixerRecommendedForCurrentLocale(e){let t=T[this.plugin.settings.locale];return t?t.includes(e):!1}showTestModal(){let e=`Voici un test... avec des "guillemets", des espaces avant ! Et des tirets -- pour voir. I'm testing (c) 2025.`,t=this.plugin.engine.processText(e),r=new window.Modal(this.app);r.setTitle("Test des corrections");let i=r.contentEl;i.createEl("h4",{text:"Texte original :"}),i.createEl("pre",{text:e,cls:"typography-test-original"}),i.createEl("h4",{text:"Texte corrig\xE9 :"}),i.createEl("pre",{text:t,cls:"typography-test-corrected"}),e===t&&i.createEl("p",{text:"\u26A0\uFE0F Aucune correction appliqu\xE9e. V\xE9rifiez que les fixers sont activ\xE9s.",cls:"typography-no-changes"}),r.open()}addCustomStyles(e){if(!e.querySelector(".typography-custom-styles")){let t=e.createEl("style",{cls:"typography-custom-styles"});t.textContent=`
                .typography-category-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-top: 24px;
                    margin-bottom: 12px;
                    padding-bottom: 8px;
                    border-bottom: 1px solid var(--background-modifier-border);
                }
                
                .typography-toggle-category {
                    font-size: 0.8em;
                    padding: 4px 8px;
                    border-radius: 4px;
                }
                
                .typography-recommended-badge {
                    display: inline-block;
                    background: var(--color-accent);
                    color: var(--text-on-accent);
                    font-size: 0.7em;
                    padding: 2px 6px;
                    border-radius: 10px;
                    margin-left: 8px;
                    font-weight: 500;
                }
                
                .typography-example {
                    margin-top: 12px;
                    padding: 12px;
                    background: var(--background-primary);
                    border: 1px solid var(--background-modifier-border);
                    border-radius: 6px;
                    font-size: 0.85em;
                    line-height: 1.4;
                }
                
                .typography-example-label {
                    font-weight: 600;
                    color: var(--text-accent);
                    margin-right: 6px;
                }
                
                .typography-example code {
                    background: var(--background-modifier-form-field);
                    color: var(--text-normal);
                    padding: 3px 6px;
                    border-radius: 4px;
                    font-family: var(--font-monospace);
                    font-size: 0.9em;
                    border: 1px solid var(--background-modifier-border-hover);
                }
                
                .typography-example-before {
                    margin-bottom: 6px;
                }
                
                .typography-example-after {
                    margin-top: 6px;
                }
                
                .typography-test-original,
                .typography-test-corrected {
                    background: var(--background-secondary);
                    padding: 12px;
                    border-radius: 4px;
                    margin: 8px 0;
                    font-family: var(--font-monospace);
                    font-size: 0.9em;
                    white-space: pre-wrap;
                }
                
                .typography-no-changes {
                    color: var(--text-warning);
                    font-style: italic;
                    margin-top: 12px;
                }
            `}}};var v=class extends p.Plugin{async onload(){try{await this.loadSettings(),this.engine=new C(this.settings),this.addCommands(),this.registerKeyboardHandlers(),this.addSettingTab(new A(this.app,this)),new p.Notice("Typography Fixers charg\xE9 avec succ\xE8s!",3e3)}catch(e){new p.Notice("Erreur lors du chargement du plugin Typography Fixers",5e3)}}onunload(){}async loadSettings(){let e=await this.loadData();this.settings=N(e||{})}async saveSettings(){await this.saveData(this.settings),this.engine&&this.engine.updateSettings(this.settings)}addCommands(){this.addCommand({id:"fix-selection",name:"Corriger la s\xE9lection",icon:"type",editorCallback:e=>{this.correctSelection(e)}}),this.addCommand({id:"fix-entire-note",name:"Corriger toute la note",icon:"whole-word",editorCallback:e=>{this.correctEntireNote(e)}}),this.addCommand({id:"toggle-realtime",name:"Basculer correction temps r\xE9el",icon:"zap",callback:async()=>{await this.toggleRealTimeCorrection()}})}correctSelection(e){let t=e.getSelection();if(t){let r=this.engine.processTextWithDetails(t);e.replaceSelection(r.corrected),this.showCorrectionNotice(r.correctionsCount,r.fixersUsed)}else this.correctEntireNote(e)}correctEntireNote(e){let t=e.getValue(),r=this.engine.processTextWithDetails(t);r.corrected!==t?(e.setValue(r.corrected),this.showCorrectionNotice(r.correctionsCount,r.fixersUsed)):new p.Notice("Aucune correction n\xE9cessaire",2e3)}async toggleRealTimeCorrection(){this.settings.enableRealTimeCorrection=!this.settings.enableRealTimeCorrection,await this.saveSettings();let e=this.settings.enableRealTimeCorrection?"activ\xE9e":"d\xE9sactiv\xE9e";new p.Notice(`Correction temps r\xE9el ${e}`,3e3)}showCorrectionNotice(e,t){if(e===0){new p.Notice("Aucune correction appliqu\xE9e",2e3);return}let r=e===1?"1 correction appliqu\xE9e":`${e} corrections appliqu\xE9es`;new p.Notice(r,3e3)}registerKeyboardHandlers(){this.registerDomEvent(document,"keydown",e=>{this.handleKeyDown(e)})}handleKeyDown(e){let t=this.app.workspace.getActiveViewOfType(p.MarkdownView);if(!t||t.getMode()!=="source")return;let r=t.editor;this.engine.handleKeyEvent(e,r)&&e.preventDefault()}getEngine(){return this.engine}async applyCorrections(e){return this.engine.processText(e)}getAvailableFixers(){return this.engine.getFixers().map(e=>e.id)}};
